{%- liquid
  assign bp = section.settings.mobile_screen_width | default: '1280' | plus: 0
  if bp == 0
    assign bp = 1280
  endif
-%}
{%- style -%}
  #shopify-section-{{ section.id }} .ug-header { margin-bottom: {{ section.settings.margin_bottom | times: 0.75 | round: 0 }}px; }
  @media (min-width: 750px) {
    #shopify-section-{{ section.id }} .ug-header { margin-bottom: {{ section.settings.margin_bottom }}px; }
  }
  @media (min-width: {{ bp }}px) {
    #shopify-section-{{ section.id }} .ug-header__row {
      display: grid;
      align-items: center;
      column-gap: 1rem;
      row-gap: 1rem;
    }
    #shopify-section-{{ section.id }} .ug-header__mobile-toggle { display: none; }
    #shopify-section-{{ section.id }} .ug-header__nav { display: flex; }
    #shopify-section-{{ section.id }} .ug-header__logo { grid-area: logo; }
    #shopify-section-{{ section.id }} .ug-header__nav { grid-area: nav; }
    #shopify-section-{{ section.id }} .ug-header__nav--secondary { grid-area: secondary; }
    #shopify-section-{{ section.id }} .ug-header__category { grid-area: category; }
    #shopify-section-{{ section.id }} .ug-header__icons { grid-area: icons; }
    {%- if section.settings.logo_position == 'middle-left' %}
    #shopify-section-{{ section.id }} .ug-header__row {
      grid-template-areas: "logo nav icons";
      grid-template-columns: 1fr auto 1fr;
    }
    {%- elsif section.settings.logo_position == 'middle' %}
    #shopify-section-{{ section.id }} .ug-header__row {
      {%- if section.settings.show_secondary_menu and section.settings.secondary_menu != blank %}
      grid-template-areas: "nav logo secondary icons";
      grid-template-columns: 1.5fr auto 1.5fr 1fr;
      {%- else %}
      grid-template-areas: "nav logo icons";
      grid-template-columns: 1fr auto 1fr;
      {%- endif %}
    }
    #shopify-section-{{ section.id }} .ug-header--logo-middle .ug-header__nav-list { justify-content: center; }
    {%- elsif section.settings.logo_position == 'top-left' %}
    #shopify-section-{{ section.id }} .ug-header__row {
      {%- if section.settings.show_category_menu and section.settings.category_menu != blank %}
      grid-template-areas: "logo category icons" "nav nav nav";
      grid-template-columns: auto 1fr auto;
      {%- else %}
      grid-template-areas: "logo . icons" "nav nav nav";
      grid-template-columns: 1fr 1fr 1fr;
      {%- endif %}
    }
    {%- elsif section.settings.logo_position == 'top-center' %}
    #shopify-section-{{ section.id }} .ug-header__row {
      {%- if section.settings.show_category_menu and section.settings.category_menu != blank %}
      grid-template-areas: "category logo icons" "nav nav nav";
      grid-template-columns: auto 1fr auto;
      {%- else %}
      grid-template-areas: ". logo icons" "nav nav nav";
      grid-template-columns: 1fr auto 1fr;
      {%- endif %}
    }
    #shopify-section-{{ section.id }} .ug-header--logo-top-center .ug-header__logo { justify-self: center; text-align: center; }
    #shopify-section-{{ section.id }} .ug-header--logo-top-center .ug-header__logo img { margin: 0 auto; }
    {%- endif %}
  }
{%- endstyle -%}
<div id="shopify-section-{{ section.id }}" class="ug-header-wrapper{% if section.settings.show_line_separator %} ug-header-wrapper--border{% endif %}{% if section.settings.enable_sticky_header %} ug-header-wrapper--sticky{% endif %}">
<header class="ug-header ug-header--logo-{{ section.settings.logo_position }} color-{{ section.settings.color_scheme }}{% if section.settings.show_secondary_menu %} ug-header--secondary-enabled{% endif %}{% if section.settings.show_category_menu %} ug-header--category-enabled{% endif %}{% if request.page_type == 'index' and section.settings.enable_transparent_header %} ug-header--transparent{% endif %}" role="banner">
  <div class="{% if section.settings.page_full_width %}page-width page-width--full{% else %}page-width{% endif %}{% if section.settings.page_full_width_spacing %} page-width--full-spacing{% endif %}">
    <div class="ug-header__row">
      <div class="ug-header__mobile-toggle" aria-label="Menu" data-open-menu>
        {% render 'ug-icon-menu' %}
      </div>
      <a href="{{ routes.root_url }}" class="ug-header__logo" {% if request.page_type == 'index' %}aria-label="{{ shop.name }}"{% endif %}>
        {% if section.settings.logo != blank %}
          <img src="{{ section.settings.logo | image_url: width: section.settings.logo_width }}" alt="{{ shop.name }}" width="{{ section.settings.logo_width }}" loading="eager">
        {% else %}
          <span class="ug-header__logo-text">{{ shop.name }}</span>
        {% endif %}
      </a>
      <nav class="ug-header__nav" aria-label="Main">
        {% if section.settings.menu != blank %}
          <ul class="ug-header__nav-list ug-header__nav-list--{{ section.settings.menu_alignment }}">
            {% for link in linklists[section.settings.menu].links %}
              {% assign has_mega = false %}
              {% for block in section.blocks %}
                {% if block.settings.menu_link_handle == link.handle %}
                  {% assign has_mega = true %}
                  {% break %}
                {% endif %}
              {% endfor %}
              <li class="ug-header__nav-item{% if has_mega %} ug-header__nav-item--mega{% endif %}{% if link.links != blank or has_mega %} ug-header__nav-item--has-dropdown{% endif %}">
                <a href="{{ link.url }}" class="ug-header__nav-link">{{ link.title }}{% if section.settings.show_dropdown_arrows and (link.links != blank or has_mega) %}<span class="ug-header__nav-arrow" aria-hidden="true">{% render 'ug-icon-caret' %}</span>{% endif %}</a>
                {% if link.links != blank or has_mega %}
                  <div class="ug-header__subnav ug-header__subnav--{{ section.settings.dropdown_style }}">
                    {% if link.links != blank %}
                      <ul class="ug-header__subnav-links">
                        {% for child in link.links %}
                          <li><a href="{{ child.url }}">{{ child.title }}</a></li>
                        {% endfor %}
                      </ul>
                    {% endif %}
                    {% for block in section.blocks %}
                      {% if block.settings.menu_link_handle == link.handle %}
                        <div class="ug-header__mega" {{ block.shopify_attributes }}>
                          {% case block.type %}
                            {% when 'mega_promo' %}
                              {% render 'ug-mega-promo', block: block, columns: block.settings.columns %}
                            {% when 'mega_banner' %}
                              <div class="ug-mega-banner">
                                {% if block.settings.image_1 != blank %}
                                  <a href="{{ block.settings.link_1 | default: '#' }}"><img src="{{ block.settings.image_1 | image_url: width: 400 }}" alt="" width="400" loading="lazy"></a>
                                {% endif %}
                                {% if block.settings.image_2 != blank %}
                                  <a href="{{ block.settings.link_2 | default: '#' }}"><img src="{{ block.settings.image_2 | image_url: width: 400 }}" alt="" width="400" loading="lazy"></a>
                                {% endif %}
                              </div>
                            {% when 'mega_brands' %}
                              {% render 'ug-mega-brands', block: block %}
                            {% when 'mega_products' %}
                              {% render 'ug-mega-products', block: block %}
                          {% endcase %}
                        </div>
                        {% break %}
                      {% endif %}
                    {% endfor %}
                  </div>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </nav>
      {% if section.settings.logo_position == 'middle' and section.settings.show_secondary_menu and section.settings.secondary_menu != blank %}
        <nav class="ug-header__nav ug-header__nav--secondary" aria-label="Secondary">
          <ul class="ug-header__nav-list ug-header__nav-list--{{ section.settings.menu_alignment }}">
            {% for link in linklists[section.settings.secondary_menu].links %}
              <li class="ug-header__nav-item"><a href="{{ link.url }}" class="ug-header__nav-link">{{ link.title }}</a></li>
            {% endfor %}
          </ul>
        </nav>
      {% endif %}
      {% if section.settings.show_category_menu and section.settings.category_menu != blank and section.settings.logo_position != 'middle' and section.settings.logo_position != 'middle-left' %}
        <div class="ug-header__category">
          <button type="button" class="ug-header__category-btn" aria-expanded="false" aria-controls="ug-header-category-list" data-ug-header-category>{{ section.settings.category_heading }}</button>
          <ul id="ug-header-category-list" class="ug-header__category-list" hidden>
            {% for link in linklists[section.settings.category_menu].links %}
              <li><a href="{{ link.url }}">{{ link.title }}</a></li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
      <div class="ug-header__icons">
        {% if section.settings.show_search %}
          <button type="button" class="ug-header__icon" aria-label="{{ 'general.search.title' | t }}" data-open-search>{% render 'ug-icon-search' %}</button>
        {% endif %}
        {% if shop.customer_accounts_enabled and section.settings.show_account %}
          <a href="{{ routes.account_url }}" class="ug-header__icon" aria-label="Account">{% render 'ug-icon-account' %}</a>
        {% endif %}
        {% if section.settings.show_header_wishlist %}
          <a href="{{ routes.root_url }}pages/wishlist" class="ug-header__icon" aria-label="Wishlist">{% render 'ug-icon-wishlist' %}</a>
        {% endif %}
        {% if section.settings.show_header_compare %}
          <a href="{{ routes.root_url }}pages/compare" class="ug-header__icon" aria-label="Compare">{% render 'ug-icon-compare' %}</a>
        {% endif %}
        {% if section.settings.show_header_cart %}
          <a href="{{ routes.cart_url }}" class="ug-header__icon ug-header__cart" aria-label="{{ 'sections.cart.title' | t }}" {% if settings.cart_type == 'drawer' %}data-open-cart-drawer{% endif %}>
            {% render 'ug-icon-cart' %}
            <span class="ug-header__cart-count" data-cart-count>{{ cart.item_count }}</span>
          </a>
        {% endif %}
        {% if section.settings.show_currency_in_header and localization.available_countries.size > 1 %}
          <div class="ug-header__currency">
            {% form 'localization', id: 'HeaderCountryForm' %}
              <label for="HeaderCountry" class="visually-hidden">{{ 'localization.country_label' | t }}</label>
              <select id="HeaderCountry" name="country_code" class="ug-header__currency-select">{% for country in localization.available_countries %}<option value="{{ country.iso_code }}" {% if country.iso_code == localization.country.iso_code %}selected{% endif %}>{{ country.currency.iso_code }} {{ country.currency.symbol }}</option>{% endfor %}</select>
              <button type="submit" class="visually-hidden">{{ 'localization.update_country' | t }}</button>
            {% endform %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="ug-header__mobile-drawer" id="ug-mobile-menu" aria-hidden="true">
    <div class="ug-header__mobile-drawer-overlay" data-close-menu></div>
    <div class="ug-header__mobile-drawer-panel">
      <button type="button" class="ug-header__mobile-close" data-close-menu aria-label="Close">{% render 'ug-icon-close' %}</button>
      {% if section.settings.menu != blank %}
        <ul class="ug-header__mobile-nav">
          {% for link in linklists[section.settings.menu].links %}
            <li><a href="{{ link.url }}">{{ link.title }}</a></li>
          {% endfor %}
          {% if section.settings.show_secondary_menu and section.settings.secondary_menu != blank %}
            {% for link in linklists[section.settings.secondary_menu].links %}
              <li><a href="{{ link.url }}">{{ link.title }}</a></li>
            {% endfor %}
          {% endif %}
        </ul>
      {% endif %}
    </div>
  </div>
</header>
</div>

{% schema %}
{
  "name": "Header",
  "max_blocks": 10,
  "settings": [
    { "type": "header", "content": "Layout" },
    { "type": "checkbox", "id": "page_full_width", "default": false, "label": "Page full width" },
    { "type": "checkbox", "id": "page_full_width_spacing", "default": false, "label": "Page full width spacing" },
    { "type": "header", "content": "Logo" },
    { "type": "select", "id": "color_scheme", "options": [
      { "value": "accent-1", "label": "Accent 1" },
      { "value": "accent-2", "label": "Accent 2" },
      { "value": "background-1", "label": "Background 1" },
      { "value": "background-2", "label": "Background 2" },
      { "value": "inverse", "label": "Inverse" }
    ], "default": "background-1", "label": "Color scheme" },
    { "type": "image_picker", "id": "logo", "label": "Logo" },
    { "type": "range", "id": "logo_width", "min": 50, "max": 250, "step": 10, "default": 100, "unit": "px", "label": "Logo width" },
    { "type": "select", "id": "logo_position", "options": [
      { "value": "middle-left", "label": "Middle left" },
      { "value": "middle", "label": "Middle" },
      { "value": "top-left", "label": "Top left" },
      { "value": "top-center", "label": "Top center" }
    ], "default": "middle-left", "label": "Logo position" },
    { "type": "select", "id": "menu_alignment", "options": [
      { "value": "left", "label": "Left" },
      { "value": "center", "label": "Center" },
      { "value": "right", "label": "Right" }
    ], "default": "center", "label": "Menu alignment" },
    { "type": "link_list", "id": "menu", "default": "main-menu", "label": "Primary menu" },
    { "type": "checkbox", "id": "show_secondary_menu", "default": false, "label": "Show secondary menu" },
    { "type": "link_list", "id": "secondary_menu", "label": "Secondary menu" },
    { "type": "checkbox", "id": "show_category_menu", "default": false, "label": "Show category menu" },
    { "type": "link_list", "id": "category_menu", "label": "Category menu" },
    { "type": "text", "id": "category_heading", "default": "Categories", "label": "Category heading" },
    { "type": "text", "id": "mobile_screen_width", "default": "1280", "label": "Mobile menu breakpoint (px)" },
    { "type": "checkbox", "id": "enable_sticky_header", "default": true, "label": "Enable sticky header" },
    { "type": "checkbox", "id": "show_line_separator", "default": false, "label": "Show line separator" },
    { "type": "checkbox", "id": "enable_transparent_header", "default": false, "label": "Transparent header on homepage" },
    { "type": "range", "id": "margin_bottom", "min": 0, "max": 100, "step": 4, "default": 0, "unit": "px", "label": "Margin bottom" },
    { "type": "header", "content": "Dropdown" },
    { "type": "select", "id": "dropdown_style", "options": [
      { "value": "default_dropdown", "label": "Default (header width)" },
      { "value": "fullwidth_dropdown", "label": "Fullwidth" },
      { "value": "container_width_dropdown", "label": "Container width" },
      { "value": "custom_width_dropdown", "label": "Custom width" }
    ], "default": "default_dropdown", "label": "Dropdown style" },
    { "type": "checkbox", "id": "show_dropdown_arrows", "default": true, "label": "Show dropdown arrows" },
    { "type": "header", "content": "Icons" },
    { "type": "checkbox", "id": "show_search", "default": true, "label": "Show search" },
    { "type": "checkbox", "id": "show_account", "default": true, "label": "Show account" },
    { "type": "checkbox", "id": "show_header_wishlist", "default": true, "label": "Show wishlist" },
    { "type": "checkbox", "id": "show_header_compare", "default": true, "label": "Show compare" },
    { "type": "checkbox", "id": "show_header_cart", "default": true, "label": "Show cart" },
    { "type": "checkbox", "id": "show_currency_in_header", "default": false, "label": "Show country/currency selector" }
  ],
  "blocks": [
    {
      "type": "mega_promo",
      "name": "Mega promo",
      "settings": [
        { "type": "text", "id": "menu_link_handle", "label": "Menu item handle (match link handle)" },
        { "type": "select", "id": "columns", "options": [{"value": "2", "label": "2"}, {"value": "3", "label": "3"}, {"value": "4", "label": "4"}], "default": "3", "label": "Columns" },
        { "type": "header", "content": "Promo 1" },
        { "type": "image_picker", "id": "image_1", "label": "Image" },
        { "type": "text", "id": "heading_1", "label": "Heading" },
        { "type": "text", "id": "button_label_1", "label": "Button" },
        { "type": "url", "id": "link_1", "label": "Link" },
        { "type": "header", "content": "Promo 2" },
        { "type": "image_picker", "id": "image_2", "label": "Image" },
        { "type": "text", "id": "heading_2", "label": "Heading" },
        { "type": "text", "id": "button_label_2", "label": "Button" },
        { "type": "url", "id": "link_2", "label": "Link" },
        { "type": "header", "content": "Promo 3" },
        { "type": "image_picker", "id": "image_3", "label": "Image" },
        { "type": "text", "id": "heading_3", "label": "Heading" },
        { "type": "text", "id": "button_label_3", "label": "Button" },
        { "type": "url", "id": "link_3", "label": "Link" },
        { "type": "header", "content": "Promo 4" },
        { "type": "image_picker", "id": "image_4", "label": "Image" },
        { "type": "text", "id": "heading_4", "label": "Heading" },
        { "type": "text", "id": "button_label_4", "label": "Button" },
        { "type": "url", "id": "link_4", "label": "Link" }
      ]
    },
    {
      "type": "mega_banner",
      "name": "Mega banner",
      "settings": [
        { "type": "text", "id": "menu_link_handle", "label": "Menu item handle" },
        { "type": "image_picker", "id": "image_1", "label": "Banner 1" },
        { "type": "url", "id": "link_1", "label": "Link 1" },
        { "type": "image_picker", "id": "image_2", "label": "Banner 2" },
        { "type": "url", "id": "link_2", "label": "Link 2" }
      ]
    },
    {
      "type": "mega_brands",
      "name": "Mega brands",
      "settings": [
        { "type": "text", "id": "menu_link_handle", "label": "Menu item handle" },
        { "type": "image_picker", "id": "image_1", "label": "Brand 1" },
        { "type": "text", "id": "title_1", "label": "Title 1" },
        { "type": "url", "id": "link_1", "label": "Link 1" },
        { "type": "image_picker", "id": "image_2", "label": "Brand 2" },
        { "type": "text", "id": "title_2", "label": "Title 2" },
        { "type": "url", "id": "link_2", "label": "Link 2" },
        { "type": "image_picker", "id": "image_3", "label": "Brand 3" },
        { "type": "text", "id": "title_3", "label": "Title 3" },
        { "type": "url", "id": "link_3", "label": "Link 3" },
        { "type": "image_picker", "id": "image_4", "label": "Brand 4" },
        { "type": "text", "id": "title_4", "label": "Title 4" },
        { "type": "url", "id": "link_4", "label": "Link 4" }
      ]
    },
    {
      "type": "mega_products",
      "name": "Mega products",
      "settings": [
        { "type": "text", "id": "menu_link_handle", "label": "Menu item handle" },
        { "type": "product", "id": "product_1", "label": "Product 1" },
        { "type": "product", "id": "product_2", "label": "Product 2" },
        { "type": "product", "id": "product_3", "label": "Product 3" },
        { "type": "product", "id": "product_4", "label": "Product 4" }
      ]
    }
  ]
}
{% endschema %}
